---
const isPreviewMode = import.meta.env.PREVIEW_MODE === 'true';
export const prerender = !isPreviewMode;  // Dynamische rendering in preview mode

import DefaultLayout from "../layouts/DefaultLayout.astro";
import { getAllUris } from "../lib/api";
import { getNodeData, getTemplateByRoute } from "../lib/routes";

export async function getStaticPaths() {
  if (isPreviewMode) {
    return []; // Geen statische paden in preview mode
  }
  return await getAllUris();
}

// Dynamische parameter ophalen
const { uri } = Astro.params;
const slug = uri ? `/${uri}/` : "/";

let node = await getNodeData(slug);
const Template = getTemplateByRoute(node);

---

<DefaultLayout
  title={node.title || "Studio Homepage"}
  description="Our amazing studio from Rotterdam"
>
  <Template data={node} />
</DefaultLayout>